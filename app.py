import streamlit as st
import pandas as pd

# ุฅุนุฏุงุฏ ุงูุตูุญุฉ
st.set_page_config(page_title="ูุธุงู ุงูุงุณุชุนูุงู ุนู ุญุตุต ุงููุนูููู", layout="wide")

st.title("๐ ุงุจุญุซ ุนู ุจูุงูุงุช ุงููุนูู")
st.write("ุฃุฏุฎู ุงุณู ุงููุนูู ูุนุฑุถ ุงููุฏุฑุณุฉุ ุนุฏุฏ ุงูุญุตุตุ ูุงููุทุงุน")

# ุชุญููู ุงูุจูุงูุงุช (ุงูููู ุงููู ุงูุช ุจุนุชู)
file_name = "data.xlsx" 

try:
    # ูุฑุงุกุฉ ุงูููู (ุชุฃูุฏ ูู ุฑูุนู ุจููุณ ุงูุงุณู data.xlsx)
    df = pd.read_excel(file_name)
    
    # ุฎุงูุฉ ุงูุจุญุซ
    search_query = st.text_input("ุงูุชุจ ุงุณู ุงููุนูู ููุง (ุฃู ุฌุฒุก ูู ุงูุงุณู):")

    if search_query:
        # ุงูุจุญุซ ูู ุนููุฏ 'ุงุณู ุงููุนูู'
        result = df[df['ุงุณู ุงููุนูู'].astype(str).str.contains(search_query, na=False, case=False)]
        
        if not result.empty:
            st.success(f"ุชู ุงูุนุซูุฑ ุนูู {len(result)} ูุนูู:")
            # ุนุฑุถ ุงููุชุงุฆุฌ ุจุดูู ุฌุฏูู ูุฑุชุจ
            st.table(result[['ุงุณู ุงููุนูู', 'ุงุณู ุงููุฏุฑุณุฉ', 'ุงูุญุตุต ุงููุนููุฉ ุงูุฃุณุจูุนูุฉ', 'ุงููุทุงุน']])
        else:
            st.warning("ุนุฐุฑุงูุ ูุฐุง ุงูุงุณู ุบูุฑ ููุฌูุฏ ูู ุงููุดูู.")
            
except Exception as e:
    st.info("ุจุฑุฌุงุก ุฑูุน ููู data.xlsx ุนูู GitHub ููุนูู ุงููููุน.")